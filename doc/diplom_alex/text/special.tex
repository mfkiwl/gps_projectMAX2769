\section{СПЕЦИАЛЬНЫЙ РАЗДЕЛ}

%--------------------------------------------------------------------------------
\subsection{Математическая модель преобразований сигнала в приемнике}
GPS приемник состоит из RF-части, IF-части и части обработки сигнала (аппаратно или программно ориентированной). RF (radio frequency)
состоит из всех компонентов до первого смесителя (рисунок \ref{pic:hw_receiver}). На приведенном рисунке в нее входят: антенна,
усилитель 1 (входит в состав активной антенны), bias-tee компонент (необходим для подачи питания с цифрового источника в аналоговый
кабель антенны для усилителя 1) и широкополосный фильтр. IF (intermidiate frequency) состоит из всех компонентов после первого
смесителя до АЦП или второго смесителя, в некоторых конструкциях приемников \cite{gps}.

\begin{figure}[H]
\begin{center}
	\scalebox{0.99}{\includegraphics[width=1\linewidth]{./pics/gps_receiver.eps}}
\end{center}
\caption{Аппаратная часть GNSS L1 приемника}
\label{pic:hw_receiver}
\end{figure}

Первым компонентом после антенны может быть усилитель (как на рисунке \ref{pic:hw_receiver}) или широкополосный фильтр. Оба
варианта имеют достоинства и недостатки.

Формула для вычисления коэффициента шума (noise figure), называется формулой Фрииса \cite{boyd} и может быть записана как:

\begin{equation}
F_{\mbox{системы}} = 
			F_1 + \frac{F_2 - 1}{G_1} + \frac{F_3 - 1}{G_1 G_2} + ... + \frac{F_N - 1}{G_1 G_2 ... G_{N1}},
		   =
			\frac{SNR_{in}}{SNR_{out}}
\label{eq:friis}
\end{equation}
где ${F_i}$ и ${G_i (i=1,2,...N)}$ - коэффициенты шума и усиления каждого компонента в RF цепи.

Если первым элементом является усилитель, то коэффициент шума приемника будет приблизительно равным коэффициенту шума
усилителя 1 (рисунок \ref{pic:hw_receiver}), который можеты быть менее 2 дБ. Влияние следующего элемента RF цепи, например 
широкополосного усилителя, на коэффициент шума будет снижен на коэффициент усиления усилителя 1 (рисунок \ref{pic:hw_receiver}).
Потенциальной проблемой данного подхода ялявется то, что при сильном уровне сигнала полоса пропускания может достичь насыщения
и начать генерировать побочные частоты.

Основной задачей смесителя на рисунке \ref{pic:hw_receiver} является перевод сигнала с высокой (RF) частоты на более низкую (IF)
частоту. GPS L1 сигнал поступает на частоте 1575.42 МГц. Основной целью данной операции явлеяется перевод сигнала
в удобный для работы диапазон частот, в частности для подачи на АЦП. В дизайне, отображенном на рисунке \ref{pic:hw_receiver},
отражен один каскад понижения частоты, однако их может быть несколько \cite{gps}. 

% software gps, page 60
Смеситель работает в соответствии с тригонометрическим выражением:

\begin{equation}
\cos(\omega_1 t)\cos(\omega_2 t) = 
	\frac{1}{2}\cos((\omega_1 - \omega_2)t) + \frac{1}{2}\cos((\omega_1 + \omega_2)t)
\label{eq:muxer}
\end{equation}

В нашем случае ${\omega_1}$ соответствует GPS L1 RF частоте 1575.42 МГц, а требуемой частотой является IF частота 2.5 МГц. В соответствии 
с этими условиями локальная частота ${\omega_2}$ должна быть (1575.42 - 2.5) = 1572.92 МГц. Таким образом первая часть формулы
\ref{eq:muxer} будет IF частотой, а вторая будет отфильтрована фильтром 2 (рисунок \ref{pic:hw_receiver}). Формула \ref{eq:muxer} 
предствляет собой упрощенную математическую модель смесителя. В реальных условиях необходимо учитывать потери передачи, нелинейные
искажения, динамические диапазоны, затухание и т.д. В сложной модели необходимо учитывать множество факторов, например
фильтр 2 (рисунок \ref{pic:hw_receiver}) выбирается так, чтобы минимизировать нелинейные искажения, полученные на смесителе.

Учитывая вышесказанное можно построить математическую модель преобразования сигнала GPS приемнике,
отображенного на рисунке \ref{pic:hw_receiver} \cite{gps}.
Пусть ${f_{L1}}$ и ${f_{L2}}$ несущие частоты сигналов L1 и L2 от спутника k. Мощности сигналов равны  ${P_C, P_{PL1}}$ и
${P_{L2}}$ для C/A и/или P кодов. Последовательность C/A кода обозначим как ${C^k(t)}$ и P(Y) кода как ${P^k(t)}$.
Навигационные данные обозначим как ${D^k(t)}$. Общий сигнал можно записать в виде:

\begin{eqnarray}
s^k(t) =	\sqrt{2P_C} C^k(t) D^k(t) \cos(2 \pi f_{L1} t) +
		\sqrt{2P_{PL1}} P^k(t) D^k(t) \cos(2 \pi f_{L1} t) + \nonumber \\
		+ \sqrt{2P_{PL2}} P^k(t) D^k(t) \cos(2 \pi f_{L2} t)
\label{eq:gps_signal}
\end{eqnarray}
Как видно в формуле \ref{eq:gps_signal} на вход RF части поступает сигнал состоящий из C/A и P(Y) 
соствляющих на частотах L1 и L2, а так же шум (в формуле не отражен).

После прохождения фильтра, компонента на несущей частоте L2 отфильтровывается и сигнал поступает на смеситель и смещается на
промежуточную частоту (IF).

\begin{eqnarray}
s^k(t) =	\sqrt{2P_C} C^k(t) D^k(t) \cos(\omega_{IF} t) +
		\sqrt{2P_{PL1}} P^k(t) D^k(t) \cos(\omega_{IF} t)
\label{eq:gps_signal_muxer}
\end{eqnarray}

Перед АЦП сигнал фильтруется узкополосным фильтром около частоты C/A кода. В следствии этого, сигнал P(Y) искажается и правая часть
выражения \ref{eq:gps_signal_muxer} превращается в шум ${e(n)}$. Сигнал после обработки АЦП может быть представлен следующим
выражением:

\begin{eqnarray}
s^k(n) =	C^k(n) D^k(n) \cos(\omega_{IF} t) + e(n),
\label{eq:gps_signal_adc}
\end{eqnarray}
с n составляющими ${1/f_s}$. Переменная n показывает дискретный характер сигнала.

Для получения навигационных данных ${D^k}$ из сигнала, отраженного в выражении \ref{eq:gps_signal_adc}, необходимо его 
перевести в основную полосу частот. Удаление несущей из сигнала выполняется умножением на локальную копию сигнала.
Если локальная копия сигнала совпадает по частоте и фазе с сигналом \ref{eq:gps_signal_adc}, результатом умножения 
будет выражение:
\begin{eqnarray}
s^k(t)	=	C^k(n) D^k(n) \cos(\omega_{IF} n) + e(n) \cos(\omega_{IF} n) = \nonumber \\
	=	-\frac{1}{2}C^k(n) D^k(n) - \frac{1}{2}\cos(2\omega_{IF} n)C^k(n) D^k(n),
\label{eq:gps_signal_lpf}
\end{eqnarray}
где первая часть представляет собой навигационное сообщение, а вторая часть - сигнал на удвоенной частоте несущей, она
отфильтровывается ФНЧ. Сигнал после ФНЧ можно представить в виде:
\begin{eqnarray}
\frac{1}{2}C^k(n) D^k(n).
\label{eq:gps_signal_ca}
\end{eqnarray}

Следующим шагом является удаление ${C_k(n)}$ C/A кода из сигнала. Это осуществляется с помощью коррелирования 
входящего сигнала с локальной копией C/A кода. Если локальная копия точно повторяет C/A код сигнала, 
выход коррелятора будет представлять:
\begin{eqnarray}
\sum_{n=0}^{N-1} C^k(n) C^k(n) D^k(n) = ND^k(n),
\label{eq:gps_signal_ca}
\end{eqnarray}
где ${ND^k(n)}$ - навигационное сообщение, представленное N-точками сигнала.

%--------------------------------------------------------------------------------
\subsection{Технология точной оценки частоты несущей}
Так как всегда присутствуют сдвиги несущей С/A кода и GPS сигнала, C/A код должен быть быть извлечен из сигнала. Процесс сопровождения 
сигнала "следует" за сигналом и декодирует информацию из навигационных сообщений. Если GPS приемник стационарный, то ожидаемое
изменение частоты, обусловленное движением навигационного спутника, очень низкое (в \cite{tsui} рассчитано максимальное 
значение для стационарного
приемника 0.936 Гц/с, для приемника движущегося с ускорением свободного падения это значение является уже очень существенным 
51.5 Гц/с).
Учитывая это, локальное изменение частоты должно так же просиходить с малой скоростью, по этой причине скорость обновления в
локальном ФАПЧ может быть тоже малой. Таким образом, для слежения за GPS сигналом необходимо два ФАПЧ модуля. Один из модулей
используется для слежения за изменением несущей частоты, он называется несущей петлей (carrier loop). Другой модуль 
используется для слежения за С/A кодом, он называется кодовой петлей (code loop).

Наиболее используемыми в программной реализации GPS приемника являются два метода: ФАПЧ (PLL) и блочная подстройка синхронизирующегося
сигнала (block adjustment of synchronizing signall - BASS). BASS метод является немного чувствительным к шуму.

Для успешной демодуляции навигационных данных необходимо получить точную локальную копию несущего сигнала. А
так же осуществляеть его подстройку с входным сигналом, чтобы исключить влияние допплеровского сдвига. Для этой 
цели можно использовать

Цель петли Костаса - попытаться сохранить всю энергию в синфазной компоненте. Для сохраниения энергии в синфазной
компоненте необходима цепь обратной связи. Если локальная копия несущей точно выровнена, смеситель в 
синфазной компоненте даст сумму:
\begin{eqnarray}
D^k(n)\cos(\omega_{IF}n + \phi) = \frac{1}{2}D^k(n)\cos(\phi) + \frac{1}{2}\cos(2\omega_{IF}n + \phi),
\label{eq:costas_i}
\end{eqnarray}
где ${\phi}$ - сдвиг фазы между локальной копией несущей и несущей входного сигнала. Смеситель в квадратурной
компоненте даст сумму:
\begin{eqnarray}
D^k(n)\sin(\omega_{IF}n + \phi) = \frac{1}{2}D^k(n)\sin(\phi) + \frac{1}{2}\sin(2\omega_{IF}n + \phi).
\label{eq:costas_q}
\end{eqnarray}
Если оба сигнала прошли через ФНЧ, компоненты с удвоенной частотой будут отфильтрованны и останется:
\begin{eqnarray}
I^k = \frac{1}{2}D^k(n)\cos(\phi), \\
Q^k = \frac{1}{2}D^k(n)\sin(\phi).
\label{eq:costas_iq}
\end{eqnarray}
Для нахождения параметра обратной связи в петле Костаса, можно использовать выражение:
\begin{eqnarray}
\frac{I^k}{Q^k} = \frac{\frac{1}{2}D^k(n)\cos(\phi)}{\frac{1}{2}D^k(n)\sin(\phi)} = \tan(\phi),
\label{eq:costas_descr}
\end{eqnarray}
\begin{eqnarray}
\phi = \tan^{-1}({\frac{Q^k}{I^k}}).
\label{eq:costas_phi}
\end{eqnarray}

Из выражения \ref{eq:costas_phi} видно, что фазовая ошибка равна нулю когда корреляция в квадратурной
компоненте нулевая, а в синфазной компоненте корреляция максимальная. Дескриминатор из выражения \ref{eq:costas_phi}
является наиболее точным дескриминатором цепи Костаса \cite{gps}, но вместе с тем наиболее долгим.
%--------------------------------------------------------------------------------
\subsection{Уточнение фазы расширяющего кода}

\newpage
